# Specify the path for the log file
$logFilePath = "C:\logs\install.log"

# Initialize variables for tracking installation status
$installedSoftware = @()
$skippedSoftware = @()
$failedSoftware = @()

try {
    # Query Configuration Manager client for available deployments
    $allDeployments = Get-WmiObject -Namespace "Root\ccm\SoftwareUpdates\DeploymentAgent" -Class CCM_Application | Select-Object DisplayName, DeploymentID

    # Display and write to log file
    foreach ($deployment in $allDeployments) {
        $message = "Software: $($deployment.DisplayName), Deployment ID: $($deployment.DeploymentID)"
        Write-Host $message
        Add-Content -Path $logFilePath -Value $message -ErrorAction Stop
    }

    # ... rest of the script for deployment ...

} catch {
    $errorMessage = "Error fetching available software deployments: $_"
    Write-Host $errorMessage
    Add-Content -Path $logFilePath -Value $errorMessage -ErrorAction SilentlyContinue
}

# ... rest of the script for deployment ...

DECLARE
   DIRECTORY_PATH VARCHAR2(100) := 'C:/sql';
BEGIN
   FOR s IN (SELECT sequence_name FROM dba_sequences) LOOP
      BEGIN
         -- Get sequence DDL
         DECLARE
            ddl CLOB;
            file_handle UTL_FILE.FILE_TYPE;
         BEGIN
            ddl := DBMS_METADATA.get_ddl('SEQUENCE',s.sequence_name);
            file_handle := UTL_FILE.fopen(DIRECTORY_PATH, 'SEQUENCE_' || s.sequence_name || '.sql', 'w');
            UTL_FILE.put_line(file_handle, ddl);
            UTL_FILE.fclose(file_handle);
         EXCEPTION
            WHEN OTHERS THEN
               DBMS_OUTPUT.put_line('Error processing sequence ' || s.sequence_name || ': ' || SQLERRM);
         END;
      END;
   END LOOP;

   FOR syn IN (SELECT synonym_name FROM dba_synonyms) LOOP
      BEGIN
         -- Get synonym DDL
         DECLARE
            ddl CLOB;
            file_handle UTL_FILE.FILE_TYPE;
         BEGIN
            ddl := DBMS_METADATA.get_ddl('SYNONYM',syn.synonym_name);
            file_handle := UTL_FILE.fopen(DIRECTORY_PATH, 'SYNONYM_' || syn.synonym_name || '.sql', 'w');
            UTL_FILE.put_line(file_handle, ddl);
            UTL_FILE.fclose(file_handle);
         EXCEPTION
            WHEN OTHERS THEN
               DBMS_OUTPUT.put_line('Error processing synonym ' || syn.synonym_name || ': ' || SQLERRM);
         END;
      END;
   END LOOP;

   FOR db_link IN (SELECT db_link FROM dba_db_links) LOOP
      BEGIN
         -- Get database link DDL
         DECLARE
            ddl CLOB;
            file_handle UTL_FILE.FILE_TYPE;
         BEGIN
            ddl := DBMS_METADATA.get_ddl('DB_LINK',db_link.db_link);
            file_handle := UTL_FILE.fopen(DIRECTORY_PATH, 'DB_LINK_' || db_link.db_link || '.sql', 'w');
            UTL_FILE.put_line(file_handle, ddl);
            UTL_FILE.fclose(file_handle);
         EXCEPTION
            WHEN OTHERS THEN
               DBMS_OUTPUT.put_line('Error processing database link ' || db_link.db_link || ': ' || SQLERRM);
         END;
      END;
   END LOOP;

   FOR tblspace IN (SELECT tablespace_name FROM dba_tablespaces) LOOP
      BEGIN
         -- Get tablespace DDL
         DECLARE
            ddl CLOB;
            file_handle UTL_FILE.FILE_TYPE;
         BEGIN
            ddl := DBMS_METADATA.get_ddl('TABLESPACE',tblspace.tablespace_name);
            file_handle := UTL_FILE.fopen(DIRECTORY_PATH, 'TABLESPACE_' || tblspace.tablespace_name || '.sql', 'w');
            UTL_FILE.put_line(file_handle, ddl);
            UTL_FILE.fclose(file_handle);
         EXCEPTION
            WHEN OTHERS THEN
               DBMS_OUTPUT.put_line('Error processing tablespace ' || tblspace.tablespace_name || ': ' || SQLERRM);
         END;
      END;
   END LOOP;

   FOR table_def IN (SELECT table_name FROM dba_tables) LOOP
      BEGIN
         -- Get table DDL
         DECLARE
            ddl CLOB;
            file_handle UTL_FILE.FILE_TYPE;
         BEGIN
            ddl := DBMS_METADATA.get_ddl('TABLE',table_def.table_name);
            file_handle := UTL_FILE.fopen(DIRECTORY_PATH, 'TABLE_' || table_def.table_name || '.sql', 'w');
            UTL_FILE.put_line(file_handle, ddl);
            UTL_FILE.fclose(file_handle);
         EXCEPTION
            WHEN OTHERS THEN
               DBMS_OUTPUT.put_line('Error processing table ' || table_def.table_name || ': ' || SQLERRM);
         END;
      END;
   END LOOP;
END;
/
